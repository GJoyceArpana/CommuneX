<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stylish Event Calendar</title>
    <style>
      /* General Styles */
      body {
        font-family: "Roboto", sans-serif;
        color: #333;
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        overflow: hidden;
        background-size: cover;
        background-position: center;
      }

      .container {
        max-width: 2000px;
        margin: 20px;
        background-color: rgba(255, 255, 255, 0.522);
        border-radius: 10px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        display: flex;
        flex-direction: column;
        overflow: hidden;
        position: relative;
        z-index: 1;
      }

      h1 {
        text-align: center;
        color: rgb(255, 255, 255);
        margin: 20px 0;
        font-size: 4em;
        text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
      }

      /* Calendar Container */
      .calendar-container {
        display: flex;
        flex-direction: row;
        flex-grow: 1;
        overflow: hidden;
      }

      /* Events Sidebar */
      .events-sidebar {
        width: 450px;
        padding: 20px;
        background-color: rgba(255, 255, 255, 0.2);
        border-right: 1px solid #ddd;
        overflow-y: auto;
      }

      .events-sidebar h2 {
        color: rgba(255, 255, 255, 0.8);
        margin-bottom: 20px;
        font-size: 1.5em;
      }

      .event-list {
        max-height: 400px;
        overflow-y: auto;
        margin-bottom: 20px;
      }

      .event-item {
        background-color: rgba(255, 255, 255, 0.1);
        padding: 15px;
        border-radius: 5px;
        margin-bottom: 10px;
        cursor: pointer;
        transition: transform 0.2s ease-in-out, background-color 0.3s;
        font-size: 1.2em;
      }

      .event-item:hover {
        background-color: rgba(255, 255, 255, 0.4);
      }

      .events-sidebar input {
        width: 100%;
        padding: 10px;
        border: 1px solid #dddddd95;
        border-radius: 5px;
        margin-bottom: 10px;
        transition: border-color 0.3s;
        font-size: 1.2em;
      }

      .events-sidebar button {
        width: 100%;
        padding: 10px;
        background-color: rgba(255, 255, 255, 0.473);
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s;
        font-size: 1.2em;
      }

      .events-sidebar button:hover {
        background-color: rgba(255, 255, 255, 0.6);
      }

      /* Calendar Main */
      .calendar-main {
        flex-grow: 1;
        padding: 20px;
        background-color: rgba(255, 255, 255, 0.2);
      }

      .calendar-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 20px;
      }

      .calendar-header button {
        background-color: rgba(255, 255, 255, 0.608);
        color: #333;
        border: none;
        padding: 15px 20px;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s;
        font-size: 2em;
      }

      .calendar-header button:hover {
        background-color: rgba(255, 255, 255, 0.911);
      }

      .calendar-grid {
        display: grid;
        grid-template-columns: repeat(7, 1fr);
        gap: 15px;
      }

      .weekday {
        font-size: 1.5em;
        color: #333;
        text-align: center;
        padding: 10px;
        background-color: rgba(255, 255, 255, 0.634);
        border-radius: 5px;
      }

      .calendar-day {
        background-color: rgba(255, 255, 255, 0.711);
        padding: 30px;
        border-radius: 5px;
        text-align: center;
        cursor: pointer;
        position: relative;
        transition: background-color 0.3s, transform 0.2s;
        color: #333;
        font-size: 1.5em;
      }

      .calendar-day:hover {
        background-color: rgba(255, 255, 255, 0.936);
        transform: scale(1.05);
      }

      /* Modals */
      .modal {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background-color: rgba(255, 255, 255, 0.818);
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 5px 20px rgba(0, 0, 0, 0.595);
        z-index: 1000;
        width: 400px;
        animation: fadeIn 0.5s ease-in-out;
        transition: all 0.3s;
      }

      .modal h2 {
        color: rgb(119, 118, 118);
        margin-bottom: 20px;
        text-align: center;
        font-size: 1.8em;
      }

      .modal input,
      .modal textarea {
        width: 100%;
        padding: 10px;
        margin-bottom: 10px;
        border: 1px solid #ddd;
        border-radius: 5px;
        transition: border-color 0.3s;
        font-size: 1.2em;
      }

      .modal button.save,
      .modal button.cancel {
        width: 100%;
        padding: 10px;
        border: none;
        border-radius: 5px;
        cursor: pointer;
        transition: background-color 0.3s;
        font-size: 1.2em;
      }

      .modal button.save {
        background-color: rgba(255, 255, 255, 0.8);
      }

      .modal button.cancel {
        background-color: rgba(255, 255, 255, 0.6);
      }

      /* Theming Options */
      .theme-toggle {
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 10px;
        background-color: rgba(255, 255, 255, 0.8);
        border: none;
        border-radius: 50%;
        cursor: pointer;
        transition: background-color 0.3s;
        font-size: 1.5em;
      }

      .theme-toggle:hover {
        background-color: rgba(255, 255, 255, 0.6);
      }

      .dark-theme .calendar-container,
      .dark-theme .modal,
      .dark-theme .event-item,
      .dark-theme .events-sidebar input {
        background-color: rgba(68, 68, 68, 0.8);
        color: #fff;
        border-color: #555;
      }

      .dark-theme .calendar-day {
        background-color: rgba(85, 85, 85, 0.8);
      }

      .dark-theme .modal button.save,
      .dark-theme .calendar-header button,
      .dark-theme .events-sidebar button {
        background-color: rgba(255, 255, 255, 0.8);
      }

      .dark-theme .modal button.cancel,
      .dark-theme .events-sidebar button:hover,
      .dark-theme .calendar-header button:hover {
        background-color: rgba(255, 255, 255, 0.6);
      }

      /* Background Image Styles */
      .background-image {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        object-fit: cover;
        z-index: -1;
        pointer-events: none;
      }
    </style>
  </head>

  <body>
    <div class="container">
      <h1>Event Calendar</h1>
      <div class="calendar-container">
        <div class="calendar-main">
          <div class="calendar-header">
            <button onclick="changeMonth(-1)">&#10094;</button>
            <div id="monthYear" style="font-size: 2em"></div>
            <!-- Increase font size -->
            <button onclick="changeMonth(1)">&#10095;</button>
          </div>
          <div id="calendarGrid" class="calendar-grid"></div>
        </div>
        <div class="events-sidebar">
          <h2>Events</h2>
          <div id="eventList" class="event-list"></div>
          <input
            id="searchInput"
            type="text"
            placeholder="Search Events"
            oninput="searchEvents()"
          />
          <button onclick="clearAllEvents()">Clear All Events</button>
        </div>
      </div>
    </div>
    <div id="eventModal" class="modal">
      <h2>Add Event</h2>
      <input id="eventInput" type="text" placeholder="Event Details" />
      <textarea
        id="descriptionInput"
        placeholder="Event Description"
      ></textarea>
      <button onclick="saveEvent()" class="save">Save Event</button>
      <button onclick="closeModal()" class="cancel">Cancel</button>
    </div>
    <div id="detailsModal" class="modal">
      <h2>Event Details</h2>
      <p id="eventDetails"></p>
      <button onclick="closeDetailsModal()" class="cancel">Close</button>
      <button onclick="editEvent()" class="save">Edit</button>
      <button onclick="deleteEvent()" class="cancel">Delete</button>
    </div>
    <button onclick="toggleTheme()" class="theme-toggle">ðŸŒ™</button>
    <script>
      const modal = document.getElementById("eventModal");
      const detailsModal = document.getElementById("detailsModal");
      const eventInput = document.getElementById("eventInput");
      const descriptionInput = document.getElementById("descriptionInput");
      const searchInput = document.getElementById("searchInput");
      const monthYear = document.getElementById("monthYear");
      const calendarGrid = document.getElementById("calendarGrid");
      const eventList = document.getElementById("eventList");
      const body = document.body;
      let selectedDay;
      let selectedEvent;

      const months = [
        "January",
        "February",
        "March",
        "April",
        "May",
        "June",
        "July",
        "August",
        "September",
        "October",
        "November",
        "December",
      ];
      let currentMonth = new Date().getMonth();
      let currentYear = new Date().getFullYear();

      if (localStorage.getItem("theme") === "dark") {
        body.classList.add("dark-theme");
      }

      function toggleTheme() {
        body.classList.toggle("dark-theme");
        localStorage.setItem(
          "theme",
          body.classList.contains("dark-theme") ? "dark" : "light"
        );
      }

      function setBackgroundImage() {
        const monthBackgrounds = [
          "january.jpg",
          "february.jpg",
          "march.jpg",
          "april.jpg",
          "may.jpg",
          "june.jpg",
          "july.jpg",
          "august.jpg",
          "september.jpg",
          "october.jpg",
          "november.jpg",
          "december.jpg",
        ];
        const container = document.querySelector(".container");
        const bgImage =
          document.querySelector(".background-image") ||
          document.createElement("img");
        bgImage.src = `${monthBackgrounds[currentMonth]}`;
        bgImage.classList.add("background-image");

        if (!document.querySelector(".background-image")) {
          document.body.prepend(bgImage);
        }
      }

      // Make sure to call setBackgroundImage initially and on month change
      setBackgroundImage();

      function generateCalendar() {
        monthYear.innerText = `${months[currentMonth]} ${currentYear}`;
        calendarGrid.innerHTML = "";
        eventList.innerHTML = "";
        setBackgroundImage(); // Set the background image based on the month

        const firstDay = new Date(currentYear, currentMonth, 1).getDay();
        const numDays = new Date(currentYear, currentMonth + 1, 0).getDate();

        const weekdays = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
        weekdays.forEach((day) => {
          let weekdayDiv = document.createElement("div");
          weekdayDiv.classList.add("weekday");
          weekdayDiv.innerText = day;
          calendarGrid.appendChild(weekdayDiv);
        });

        for (let i = 0; i < firstDay; i++) {
          let emptyCell = document.createElement("div");
          calendarGrid.appendChild(emptyCell);
        }

        for (let day = 1; day <= numDays; day++) {
          let dayCell = document.createElement("div");
          dayCell.classList.add("calendar-day");
          dayCell.innerText = day;
          dayCell.onclick = () => openModal(dayCell);
          calendarGrid.appendChild(dayCell);

          let storedEvents = JSON.parse(
            localStorage.getItem(`${currentYear}-${currentMonth + 1}-${day}`)
          );
          if (storedEvents) {
            storedEvents.forEach((event) => {
              let eventDot = document.createElement("div");
              eventDot.classList.add("event-dot");
              dayCell.appendChild(eventDot);
              dayCell.classList.add("selected-day");

              let eventItem = document.createElement("div");
              eventItem.classList.add("event-item");
              eventItem.innerText = `${months[currentMonth]} ${day}: ${event.eventText}`;
              eventItem.onclick = () => showEventDetails(event, dayCell);
              eventList.appendChild(eventItem);

              scheduleNotification(event.eventText, event.notificationTime);
            });
          }
        }
      }

      function openModal(day) {
        selectedDay = day;
        modal.style.display = "block";
        eventInput.value = "";
        descriptionInput.value = "";
      }

      function closeModal() {
        modal.style.display = "none";
      }

      function showEventDetails(event, dayCell) {
        selectedEvent = event;
        selectedDay = dayCell;
        document.getElementById("eventDetails").innerText = `
        Event: ${event.eventText}
        Description: ${event.descriptionText}
        Date: ${months[currentMonth]} ${selectedDay.innerText}
      `;
        detailsModal.style.display = "block";
      }

      function closeDetailsModal() {
        detailsModal.style.display = "none";
      }

      function saveEvent() {
        if (eventInput.value.trim()) {
          let dayText = selectedDay.innerText;
          let eventText = eventInput.value;
          let descriptionText = descriptionInput.value;
          let notificationTime = new Date();
          notificationTime.setDate(selectedDay.innerText);
          notificationTime.setMonth(currentMonth);
          notificationTime.setFullYear(currentYear);
          let storedEvents =
            JSON.parse(
              localStorage.getItem(
                `${currentYear}-${currentMonth + 1}-${dayText}`
              )
            ) || [];
          storedEvents.push({
            eventText,
            descriptionText,
            notificationTime,
          });
          localStorage.setItem(
            `${currentYear}-${currentMonth + 1}-${dayText}`,
            JSON.stringify(storedEvents)
          );

          let eventDot = document.createElement("div");
          eventDot.classList.add("event-dot");
          selectedDay.appendChild(eventDot);
          selectedDay.classList.add("selected-day");

          let eventItem = document.createElement("div");
          eventItem.classList.add("event-item");
          eventItem.innerText = `${months[currentMonth]} ${dayText}: ${eventText}`;
          eventItem.onclick = () =>
            showEventDetails(
              {
                eventText,
                descriptionText,
                notificationTime,
              },
              selectedDay
            );
          eventList.appendChild(eventItem);

          scheduleNotification(eventText, notificationTime);
        }
        closeModal();
      }

      function editEvent() {
        eventInput.value = selectedEvent.eventText;
        descriptionInput.value = selectedEvent.descriptionText;
        closeDetailsModal();
        modal.style.display = "block";
      }

      function deleteEvent() {
        let dayText = selectedDay.innerText;
        let storedEvents =
          JSON.parse(
            localStorage.getItem(
              `${currentYear}-${currentMonth + 1}-${dayText}`
            )
          ) || [];
        storedEvents = storedEvents.filter(
          (event) => event.eventText !== selectedEvent.eventText
        );
        localStorage.setItem(
          `${currentYear}-${currentMonth + 1}-${dayText}`,
          JSON.stringify(storedEvents)
        );
        closeDetailsModal();
        generateCalendar();
      }

      function clearAllEvents() {
        localStorage.clear();
        generateCalendar();
      }

      function searchEvents() {
        const query = searchInput.value.toLowerCase();
        const events = eventList.querySelectorAll("div");
        events.forEach((event) => {
          if (event.innerText.toLowerCase().includes(query)) {
            event.style.display = "block";
          } else {
            event.style.display = "none";
          }
        });
      }

      function changeMonth(direction) {
        currentMonth += direction;
        if (currentMonth > 11) {
          currentMonth = 0;
          currentYear++;
        } else if (currentMonth < 0) {
          currentMonth = 11;
          currentYear--;
        }
        generateCalendar();
      }

      function scheduleNotification(eventText, notificationTime) {
        const delay = notificationTime - new Date();
        if (delay > 0) {
          setTimeout(() => {
            new Notification("Event Reminder", {
              body: `Reminder: ${eventText}`,
            });
          }, delay);
        }
      }

      if ("Notification" in window && Notification.permission !== "granted") {
        Notification.requestPermission();
      }

      generateCalendar();
    </script>
  </body>
</html>
